    // BEGIN fair-draw-module
    const tirageEquitable=(()=>{
      if(typeof window!=="undefined"&&window.tirageEquitable){return window.tirageEquitable;}
      const historique=[];
      let dernierJoueur=null;
      const capaciteHistorique=taille=>{if(!Number.isFinite(taille)||taille<=0){return 0;}return Math.min(15,Math.floor(taille/2));};
      const construireEligibles=(liste,filtre,fenetre,exclureDernier)=>{
        const historiqueActif=fenetre>0?new Set(historique.slice(-fenetre)):new Set();
        const resultat=[];
        for(let i=0;i<liste.length;i+=1){
          const joueur=liste[i];
          if(exclureDernier&&dernierJoueur!==null&&joueur===dernierJoueur){continue;}
          if(fenetre>0&&historiqueActif.has(joueur)){continue;}
          if(!filtre(joueur,i,liste)){continue;}
          resultat.push(joueur);
        }
        return resultat;
      };
      const tirer=(listeJoueurs,filtre)=>{
        if(!Array.isArray(listeJoueurs)||!listeJoueurs.length){return null;}
        const filtreEffectif=typeof filtre==="function"?filtre:()=>true;
        const capacite=capaciteHistorique(listeJoueurs.length);
        let fenetre=capacite;
        let eligibles=construireEligibles(listeJoueurs,filtreEffectif,fenetre,true);
        while(!eligibles.length&&fenetre>0){
          fenetre-=1;
          eligibles=construireEligibles(listeJoueurs,filtreEffectif,fenetre,true);
        }
        if(!eligibles.length){
          eligibles=construireEligibles(listeJoueurs,filtreEffectif,0,false);
        }
        if(!eligibles.length){return null;}
        const selection=eligibles[Math.floor(Math.random()*eligibles.length)];
        dernierJoueur=selection;
        historique.push(selection);
        const capaciteFinale=capaciteHistorique(listeJoueurs.length);
        while(historique.length>capaciteFinale){historique.shift();}
        return selection;
      };
      return{tirer,getHistorique:()=>[...historique],getDernier:()=>dernierJoueur};
    })();
    if(typeof window!=="undefined"){window.tirageEquitable=tirageEquitable;}
    // END fair-draw-module
        // BEGIN fair-draw-culture-selection
        const player=tirageEquitable.tirer(players);
        if(!player){return;}
        // END fair-draw-culture-selection
      else if(mode==="debut"||mode==="hardcore"||mode==="alcool"){const pool={debut:debutQuestions,hardcore:hardcoreQuestions,alcool:alcoolQuestions}[mode];const [type,text]=pool[Math.floor(Math.random()*pool.length)].split("|");
        // BEGIN fair-draw-classic-selection
        const player=tirageEquitable.tirer(players);
        if(!player){return;}
        // END fair-draw-classic-selection
        let qText=text.replace(/\{player\}/g,player);if(qText.includes("{other}")){let other;do{other=players[Math.floor(Math.random()*players.length)];}while(other===player&&players.length>1);qText=qText.replace(/\{other\}/g,other);}typeBox.textContent=type;setBackground(type);currentQuestionEl.textContent=qText;}}
